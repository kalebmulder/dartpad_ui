<!DOCTYPE html>

<html>
  <head>
  	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <style>
      body {
        color: #ddd;
        margin: 0;
        padding: 0;
        font-family: 'Roboto', sans-serif;
        font-size: 14px;
      }
    </style>
    <script>
messageHandler = function(e) {
  // TODO: verify the domain is correct

  var obj = e.data;
  var command = obj.command;

  // TODO: sanitize all this data

  if (command == 'setCss') {
    document.getElementById('styleid').innerHTML = obj.data;
  } else if (command == 'setHtml') {
    document.querySelector('body').innerHTML = obj.data;
  } else if (command == 'setJavaScript') {
    // Remove old node.
    var node = document.getElementById('scriptid');
    if (node && node.parentNode) {
      node.parentNode.removeChild(node);
    }

    // Create new node.
    var s = document.createElement('script');
    s.text = obj.data;
    document.head.appendChild(s);
  } else if (command == 'reset') {
    // TODO:
    console.log('TODO: reset');
  }
}

window.addEventListener('message', messageHandler, false);
    </script>

    <style id="styleid"></style>
    <script id="scriptid"></script>
  </head>

  <body></body>
</html>
